{% extends 'base.html' %} {% block content %} {% include 'preloader.html' %}
<div class="row task-maincontent" ng-controller="projectController">
    {% verbatim %}
    <div class="col m3 project_names">
        <div class="row">
            <div class="col m12">
                <div class="card   blue-grey lighten-5" ng-click="current_project('all_projects',0)">
                    <div class="card-content">
                        <span class="card-title">All Projects</span>
                        <p>Total Projects: {{summary_project.project_count}}</p>
                        <p>Total Tasks: {{summary_project.task_count}}</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="row" ng-repeat="project in projects">
            <div class="col m12">
                <div class="card   blue-grey lighten-5" ng-click="current_project(project.name,project.id)">
                    <div class="card-content">
                        <span class="card-title">{{project.name}}</span>
                        <p></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endverbatim %}
    <div class="col m9">
        <div class="row">
            <div class="col m6">
                <div class="owl-carousel owl-theme project_dates" ng-show="selected_project!='all_projects'">
                    {% for date in date_range%}
                    <div ng-click=" selectedDate($event) ">
                        {{date|date:'d M,y'}}
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% verbatim %}
            <div class="col m6 " ng-show="selected_project!='all_projects' ">
                <div>
                    <span ng-repeat="member in members">
                        <a ng-click="selectMember(member.id)" tooltips tooltip-template="{{member.role.name}}" tooltip-smart="true">{{member.user.username}}</a>
                    </span>
                </div>
            </div>
            {% endverbatim %}
        </div>
        {% verbatim %}
        <div class="row ">
            <div class="col m7 " ng-show="selected_project=='all_projects' ">
                <h3>All Projects</h3>
                <ul class="collapsible popout" data-collapsible="accordion">
                    <li ng-repeat="(project,tasks) in summary_project.tasks|groupBy:'project_set[0].name'">
                        <div class="collapsible-header">
                            {{project}}
                        </div>
                        <div class="collapsible-body" ng-repeat="task in tasks">
                            <div>
                                {{task.name}}
                            </div>
                            <div>
                                <span>
                                  Percentage Completed: {{task.percentage_complete}}%
                                </span>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
            <div class="col m7 " ng-show="selected_project!='all_projects' ">
                <h3>{{selected_project}}</h3>
                <div ng-if="tasks.length==0">
                    No task for {{selected_date|date:'dd MMM,yy'}}
                </div>
                <div ng-repeat="task in tasks | orderBy : 'percentage_complete'">
                    <div class="row">
                        <div class="col s12 m10">
                            <div class="card blue-grey darken-1">
                                <div class="card-content white-text">
                                    <p>{{task.name}}</p>
                                </div>
                                <div class="card-action">
                                    <a class="assign_operation" href="#">{{task.percentage_complete}}% Completed</a>
                                    <a class="assign_operation" ng-click="edittaskPutBack(this)">Put Back</a>
                                    <a class="assign_operation" ng-click="editPercentage(this)">Edit</a>
                                    <div class="row" ng-if="showPutBack">
                                        <div class="col m9">
                                            <p class="input-field col m12">
                                                <input type="text" id="{{task.id}}" ng-model="reason"/>
                                            </p>
                                        </div>
                                        <div class="col m3">
                                            <a ng-click="taskPutBack(reason,task.id)">Save</a>
                                        </div>
                                    </div>
                                    <div class="row" ng-if="showRange">
                                        <div class="col m9">
                                            <p class="range-field">
                                                <input type="range" id="{{task.id}}" value="{{task.percentage_complete}}" min="0" max="100" />
                                            </p>
                                        </div>
                                        <div class="col m3">
                                            <a ng-click="savePercentage(task.id)">Save</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- task queues -->
            <div class="col m5 " ng-show="selected_project!='all_projects' ">
                <div class="task-panel ">
                    <ul ng-repeat="task in queue " class="task_list ">
                        <div class="row ">
                            <div class="col m12 ">
                                <div class="card   blue-grey lighten-5">
                                    <div class="card-content">
                                        <p>{{task.name}}</p>
                                    </div>
                                    <div ng-if="task.assigned_to==null">
                                        <div class="card-action ">
                                            <a ng-click="assignDate(this, task.id)" class="assign_operation">Assign To Yourself</a>
                                            <a ng-click="assignTask(this, task.id)" class="assign_operation">Assign To Other</a>
                                            <div ng-show="taskDate" class="row">
                                                <div class="input-field col m9">
                                                    <label for="date">Choose the date</label>
                                                    <input type="date" id="your_date{{task.id}}" class="datepicker" ng-model="taskAssignDate">
                                                </div>
                                                <div class="input-field col m3">
                                                    <a ng-click="assignYourself(task.id)">Confirm</a>
                                                </div>
                                            </div>
                                            <div ng-show="taskToOther" class="row">
                                                <div class="input-field col m9">
                                                    <input type="text" id="autocomplete-input" class="autocomplete" ng-model="otherMember">
                                                    <label for="autocomplete-input">Choose Member</label>
                                                </div>
                                                <div class="clearfix"></div>
                                                <div class="input-field col m9">
                                                    <label for="date">Choose the date</label>
                                                    <input type="date" id="other_task{{task.id}}" class="datepicker" ng-model="taskAssignDate">
                                                </div>
                                                <div class="input-field col m3">
                                                    <a ng-click="assignToOther(task.id)">Confirm</a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div ng-if="task.assigned_to!=null">
                                        <div class="card-action ">
                                            <a href="#">{{task.assigned_to.user.username}}</a>
                                            <a href="#">{{task.percentage_complete}} % Completed</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </ul>
                </div>
                <form ng-submit="addtask() " class="form_list ">
                    <div class="row ">
                        <div class="input-field col m8">
                            <textarea id="task_name " ng-model="task " class="materialize-textarea "></textarea>
                            <label for="task_name ">Task:</label>
                        </div>
                        <div class="m4 ">
                            <button class="btn waves-effect waves-light " type="submit " name="action " id="save_task ">Save
                            </button>
                        </div>
                    </div>
                </form>
            </div>
            <!-- task queues ends -->
        </div>
        {% endverbatim %}
    </div>
</div>
{% endblock %} {% block extra_js%}
<script>
$('.project_dates, .project_members').owlCarousel({
    loop: false,
    rewind: false,
    responsive: {
        0: {
            items: 3,
            nav: true
        },
        600: {
            items: 4,
            nav: true
        },
        1000: {
            items: 5,
            nav: true
        }
    }
});
$('.collapsible').collapsible('open', 0);
$('.tooltipped').tooltip({
    delay: 50
});
</script>
{% endblock%}